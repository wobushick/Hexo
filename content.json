{"meta":{"title":"Haoren's Blog","subtitle":"é™å¿ƒæ€è€ƒï¼Œæ²‰æµ¸å­¦ä¹ ","description":"æŠ€æœ¯åˆ†äº« | å­¦ä¹ ç¬”è®° | ä¸ªäººæˆé•¿","author":"haoren","url":"https://github.io/wobushick/Hexo","root":"/Hexo/"},"pages":[{"title":"","date":"2025-07-15T07:40:10.712Z","updated":"2025-07-15T07:40:10.712Z","comments":true,"path":"about/index.html","permalink":"https://github.io/wobushick/Hexo/about/index.html","excerpt":"","text":"è¿™æ˜¯æˆ‘çš„ä¸ªäººçŸ¥è¯†åº“å’ŒæŠ€æœ¯åšå®¢ï¼Œä¸»è¦ç”¨äºæ•´ç†å’Œåˆ†äº«ä»¥ä¸‹å†…å®¹ï¼š ğŸ” æŠ€æœ¯ç¬”è®°è®°å½•ç¯å¢ƒæ­å»ºå’Œå·¥å…·ä½¿ç”¨ä¸­çš„æŠ€æœ¯ç»†èŠ‚ âœï¸ å­¦ä¹ æ€»ç»“æ•´ç†å­¦ä¹ è¿‡ç¨‹ä¸­çš„çŸ¥è¯†æ¡†æ¶å’Œå®è·µç»éªŒ ğŸŒ èµ„æºç´¢å¼•åˆ†ç±»æ”¶è—é«˜è´¨é‡çš„æŠ€æœ¯æ–‡æ¡£å’Œå®ç”¨èµ„æº ğŸ¯ ç½‘ç«™ç›®çš„é€šè¿‡ç³»ç»ŸåŒ–æ¢³ç†å¼ºåŒ–çŸ¥è¯†æ²‰æ·€ä¿æŒæŒç»­å­¦ä¹ ä¸è¾“å‡ºçš„èŠ‚å¥"},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2025-07-15T07:40:10.713Z","updated":"2025-07-15T07:40:10.713Z","comments":true,"path":"categories/index.html","permalink":"https://github.io/wobushick/Hexo/categories/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2025-07-15T07:40:10.713Z","updated":"2025-07-15T07:40:10.713Z","comments":true,"path":"tags/index.html","permalink":"https://github.io/wobushick/Hexo/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"DMLæ•°æ®æ“ä½œ","slug":"DMLæ•°æ®æ“ä½œ","date":"2025-07-14T16:00:00.000Z","updated":"2025-07-15T07:40:10.712Z","comments":true,"path":"2025/07/14/DMLæ•°æ®æ“ä½œ/","permalink":"https://github.io/wobushick/Hexo/2025/07/14/DML%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/","excerpt":"","text":"æ•°æ®æ“ä½œå³æ•°æ®çš„å¢åˆ æ”¹ Load å°†æ–‡ä»¶å¯¼å…¥åˆ°hiveè¡¨ä¸­,å¹¶ä¸éœ€è¦æŸ¥è¯¢ â€‹â€‹LOAD DATA LOCAL INPATH &#39;/local/file/system/path&#39; [OVERWRITE] INTO TABLE tablename [PARTITION (part1=val1, part2=val2 ...)]â€‹â€‹ LOCAL: è¡¨ç¤ºæºæ–‡ä»¶åœ¨å®¢æˆ·ç«¯æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚ â€‹OVERWRITE**:â€‹â€‹ è¦†ç›–ç›®æ ‡è¡¨&#x2F;åˆ†åŒºä¸­çš„æ•°æ®ã€‚ â€‹â€‹INTO:â€‹â€‹ è¿½åŠ æ•°æ®ã€‚ æ–‡ä»¶ä¼šè¢«ç§»åŠ¨åˆ° Hive çš„æ•°æ®ä»“åº“ç›®å½•ä¸­ã€‚ LOAD DATA INPATH &#39;hdfs://namenode/path/to/hdfs/file&#39; [OVERWRITE] INTO TABLE ..â€‹â€‹ æºæ–‡ä»¶åœ¨ HDFS ä¸Šï¼ˆæ—  LOCAL å…³é”®å­—ï¼‰ã€‚ æ–‡ä»¶ä¼šè¢«ç§»åŠ¨ï¼ˆè€Œä¸æ˜¯å¤åˆ¶ï¼‰åˆ°ç›®æ ‡ Hive ä½ç½®ã€‚æºæ–‡ä»¶å°†ä¸å­˜åœ¨äºåŸæ¥è·¯å¾„ã€‚ â€‹â€‹æ³¨æ„:â€‹â€‹ æ–‡ä»¶å†…å®¹å¿…é¡»ä¸è¡¨çš„å®šä¹‰ï¼ˆå­—æ®µåˆ†éš”ç¬¦ã€é›†åˆåˆ†éš”ç¬¦ç­‰ï¼‰ç›¸åŒ¹é…ã€‚ ä¸ä¼šå¯¹æ•°æ®è¿›è¡Œä»»ä½•è½¬æ¢ï¼ˆå¦‚ CSV è½¬ ORCï¼‰ï¼Œä»…åšç§»åŠ¨æˆ–å¤åˆ¶æ“ä½œã€‚ åŠ è½½æ•°æ®åå»ºè®®è¿è¡Œ ANALYZE TABLE ... COMPUTE STATISTICS æˆ– msck repair table ... (ä¿®å¤åˆ†åŒºå…ƒæ•°æ®) ä»¥ä¼˜åŒ–æŸ¥è¯¢è®¡åˆ’ã€‚ SELECT æ ¸å¿ƒ:æ£€ç´¢è¡¨ä¸­çš„æ•°æ® â€‹â€‹å…³é”®ç‰¹æ€§ï¼šâ€‹â€‹ â€‹â€‹è¿‡æ»¤ï¼šâ€‹â€‹ ä½¿ç”¨ WHERE å­å¥ã€‚ â€‹â€‹èšåˆï¼šâ€‹â€‹ ä½¿ç”¨ GROUP BY å’Œèšåˆå‡½æ•°ï¼ˆå¦‚ SUM, AVG, COUNT, MAX, MINï¼‰ã€‚ â€‹â€‹æ’åºï¼šâ€‹â€‹ ä½¿ç”¨ ORDER BYï¼ˆå…¨å±€æ’åºï¼‰æˆ– SORT BYï¼ˆReducer å†…æ’åºï¼‰ã€‚ â€‹â€‹é™åˆ¶ï¼šâ€‹â€‹ ä½¿ç”¨ LIMITã€‚ â€‹â€‹è¿æ¥ï¼šâ€‹â€‹ æ”¯æŒ INNER JOIN, LEFT OUTER JOIN, RIGHT OUTER JOIN, FULL OUTER JOIN, LEFT SEMI JOIN, CROSS JOINã€‚ â€‹â€‹è§†å›¾ï¼šâ€‹â€‹ æŸ¥è¯¢ç»“æœå¯ä»¥æŒä¹…åŒ–ä¸ºè§†å›¾ã€‚ â€‹â€‹å­æŸ¥è¯¢ï¼šâ€‹â€‹ æ”¯æŒåœ¨ FROMã€WHERE å’Œ HAVING å­å¥ä¸­ä½¿ç”¨å­æŸ¥è¯¢ï¼ˆéƒ¨åˆ†æ—§ç‰ˆæœ¬æœ‰é™åˆ¶ï¼‰ã€‚ â€‹â€‹åˆ†åŒºè£å‰ªï¼šâ€‹â€‹ æŸ¥è¯¢æŒ‡å®šåˆ†åŒºå¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ï¼ˆWHERE part_column = &#39;value&#39;ï¼‰ã€‚ â€‹â€‹**DISTRIBUTE BY** &#x2F; **CLUSTER BY**:â€‹â€‹ æ§åˆ¶æ•°æ®å¦‚ä½•åˆ†å¸ƒåœ¨ Reducer ä¹‹é—´è¿›è¡Œåç»­å¤„ç†ï¼ˆå¦‚ SORT BYï¼‰ã€‚ INSERTâ€‹ â€‹â€‹æ ¸å¿ƒï¼šâ€‹â€‹ å°†æŸ¥è¯¢ç»“æœæˆ–æ•°æ®å†™å…¥ Hive è¡¨ã€‚ â€‹â€‹ä¸»è¦å½¢å¼:â€‹â€‹ â€‹INSERT OVERWRITE TABLE target_table [PARTITION (part_col1=val1, part_col2=val2 ...)] SELECT ... FROM ...â€‹ è¦†ç›–ï¼š_å®Œå…¨æ›¿æ¢_ç›®æ ‡è¡¨æˆ–æŒ‡å®šåˆ†åŒºä¸­çš„æ•°æ®ã€‚ â€‹INSERT INTO TABLE target_table [PARTITION (part_col1=val1, part_col2=val2 ...)] SELECT ... FROM ...â€‹ è¿½åŠ ï¼šå°†æŸ¥è¯¢ç»“æœ_è¿½åŠ _åˆ°ç›®æ ‡è¡¨æˆ–æŒ‡å®šåˆ†åŒºä¸­å·²æœ‰æ•°æ®ä¹‹åã€‚ â€‹INSERT OVERWRITE [LOCAL] DIRECTORY &#39;path&#39; [ROW FORMAT ...] [STORED AS ...] SELECT ...â€‹ å°†æŸ¥è¯¢ç»“æœå†™å…¥ HDFS æˆ–æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•ã€‚ LOCAL è¡¨ç¤ºå†™å…¥æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚ å¯ä»¥æŒ‡å®šè¾“å‡ºæ ¼å¼å’Œåˆ†éš”ç¬¦ã€‚ â€‹â€‹åŠ¨æ€åˆ†åŒºæ’å…¥ï¼šâ€‹â€‹ åœ¨ INSERT è¯­å¥ä¸­ï¼Œåˆ†åŒºåˆ—çš„å€¼ç”± SELECT å­å¥çš„ç»“æœåŠ¨æ€ç¡®å®šã€‚ éœ€è¦è®¾ç½® hive.exec.dynamic.partition.mode=nonstrictï¼ˆé»˜è®¤ä¸º strictï¼‰ã€‚ ä¾‹å¦‚ï¼šINSERT OVERWRITE TABLE sales PARTITION (country, state) SELECT ..., se_country, se_state FROM source_table; â€‹â€‹å¤šè¡¨æ’å…¥ (Multi Table Insert - MTI):â€‹â€‹ é€šè¿‡ä¸€ä¸ªæŸ¥è¯¢å’Œå¤šä¸ª INSERT å­å¥ï¼Œå°†ç»“æœåŒæ—¶å†™å…¥å¤šä¸ªç›®æ ‡è¡¨ã€‚ è¯­æ³•ï¼š 123FROM source_tableINSERT OVERWRITE TABLE target_table1 SELECT col1, col2 ...INSERT INTO TABLE target_table2 SELECT col3, col4 ... UPDATE â€‹â€‹æ ¸å¿ƒï¼šâ€‹â€‹ ä¿®æ”¹è¡¨ä¸­ç°æœ‰è¡Œã€‚ â€‹â€‹å…³é”®ç‚¹ï¼šâ€‹â€‹ â€‹â€‹ä»…é€‚ç”¨äºäº‹åŠ¡è¡¨ï¼šâ€‹â€‹ è¡¨å¿…é¡»é…ç½®ä¸ºæ”¯æŒ ACIDï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰äº‹åŠ¡ã€‚ â€‹â€‹å‰ææ¡ä»¶ï¼šâ€‹â€‹ è¡¨å¿…é¡»æ˜¯åˆ†æ¡¶è¡¨ (CLUSTERED BY)ã€‚ è¡¨æ–‡ä»¶æ ¼å¼å¿…é¡»æ˜¯ ORCï¼ˆæ¨èï¼Œæ€§èƒ½æœ€ä½³ï¼‰ã€‚ å¿…é¡»è®¾ç½® hive.support.concurrency=true, hive.enforce.bucketing=true, hive.exec.dynamic.partition.mode=nonstrict, hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager (æˆ–å…¶ç­‰æ•ˆæ›¿ä»£å“)ã€‚ â€‹â€‹è¯­æ³•ï¼šâ€‹â€‹ UPDATE tablename SET column = value [, column = value ...] [WHERE expression]; â€‹â€‹æ³¨æ„ï¼šâ€‹â€‹ å¯¹äºæµ·é‡æ•°æ®çš„æ›´æ–°æ“ä½œï¼Œä¼ ç»Ÿä¸Šæ›´é«˜æ•ˆçš„æ–¹æ³•æ˜¯ä½¿ç”¨ INSERT OVERWRITE é‡å†™æ•´ä¸ªåˆ†åŒºæˆ–è¡¨ã€‚ DELETE â€‹â€‹æ ¸å¿ƒï¼šâ€‹â€‹ åˆ é™¤è¡¨ä¸­çš„è¡Œã€‚ â€‹â€‹å…³é”®ç‚¹ï¼šâ€‹â€‹ â€‹â€‹ä»…é€‚ç”¨äºäº‹åŠ¡è¡¨ï¼šâ€‹â€‹ è¦æ±‚ä¸ UPDATE æ“ä½œå®Œå…¨ç›¸åŒï¼ˆåˆ†æ¡¶è¡¨ã€ORC æ ¼å¼ã€ACID é…ç½®ï¼‰ã€‚ â€‹â€‹è¯­æ³•ï¼šâ€‹â€‹ DELETE FROM tablename [WHERE expression]; â€‹â€‹æ³¨æ„ï¼šâ€‹â€‹ å¦‚æœåªæƒ³åˆ é™¤æ‰€æœ‰è¡Œï¼ŒTRUNCATE TABLE tablename; æ˜¯ä¸€ä¸ªæ›´é«˜æ•ˆçš„é€‰é¡¹ï¼ˆä½†å®ƒåˆ é™¤æ•´ä¸ªè¡¨æ•°æ®ï¼Œä¸èƒ½å¸¦ WHEREï¼‰ï¼Œä½†äº‹åŠ¡è¡¨ä¸Šä¹Ÿè¦æ±‚ç±»ä¼¼é…ç½®ã€‚ åŒæ ·ï¼Œå¤§è§„æ¨¡åˆ é™¤é€šå¸¸æ›´å€¾å‘äºé‡å†™åˆ†åŒºã€‚ MERGE(Hivw2.2+å¼•å…¥) â€‹â€‹æ ¸å¿ƒï¼šâ€‹â€‹ åœ¨ä¸€æ¡è¯­å¥ä¸­æ ¹æ®æ¡ä»¶æ‰§è¡Œ INSERT, UPDATE, DELETE æ“ä½œã€‚ä¹Ÿç§°ä¸º â€œUpsertâ€ã€‚ä¸»è¦ç”¨äºå˜æ›´æ•°æ®æ•è·å¤„ç†ã€‚ â€‹â€‹å…³é”®ç‚¹ï¼šâ€‹â€‹ â€‹â€‹ä»…é€‚ç”¨äºäº‹åŠ¡è¡¨ï¼šâ€‹â€‹ è¦æ±‚ä¸ UPDATE ç›¸åŒã€‚ â€‹â€‹è¯­æ³•ï¼šâ€‹â€‹ ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦æŒ‡å®šæºè¡¨ã€è¿æ¥æ¡ä»¶ä»¥åŠåœ¨åŒ¹é…å’Œä¸åŒ¹é…æƒ…å†µä¸‹æ‰§è¡Œçš„æ“ä½œã€‚ åŸºæœ¬ç»“æ„ï¼š 1234567MERGE INTO target_table AS TUSING source_table AS SON T.key = S.keyWHEN MATCHED [AND some_condition] THEN UPDATE SET ... [DELETE WHERE ...] -- å¯é€‰ DELETE å­å¥WHEN MATCHED [AND some_condition] THEN DELETE -- åˆ é™¤åŒ¹é…è¡Œï¼ˆå¯é€‰ï¼‰WHEN NOT MATCHED [AND some_condition] THEN INSERT VALUES (...) -- æ’å…¥æ–°è¡ŒWHEN NOT MATCHED BY SOURCE [AND some_condition] THEN ... -- (å¯é€‰) å¤„ç†ç›®æ ‡æœ‰ä½†æºæ²¡æœ‰çš„è¡Œ ğŸ“Œ é‡è¦æ³¨æ„äº‹é¡¹ â€‹â€‹æ¨¡å¼å†™&#x2F;è¯» (Schema-on-Read)ï¼šâ€‹â€‹ Hive åœ¨æ•°æ®åŠ è½½æ—¶ä¸å¼ºåˆ¶æ£€æŸ¥æ•°æ®æ¨¡å¼ä¸è¡¨å®šä¹‰æ˜¯å¦å®Œå…¨åŒ¹é…ã€‚ä»…åœ¨æŸ¥è¯¢æ—¶éªŒè¯ã€‚é”™è¯¯çš„æ ¼å¼åœ¨åŠ è½½è¿‡ç¨‹ä¸­å¯èƒ½ä¸ä¼šè¢«å‘ç°ï¼Œä½†åœ¨æŸ¥è¯¢æ—¶ä¼šå¼•å‘è§£æé”™è¯¯ã€‚ â€‹â€‹ä¸å¯å˜æ€§ (å†å²é™åˆ¶)ï¼šâ€‹â€‹ æ—©æœŸ Hive è®¾è®¡ï¼ˆéäº‹åŠ¡è¡¨ï¼‰ä¸­ HDFS æ–‡ä»¶çš„ä¸å¯å˜æ€§é™åˆ¶äº† UPDATE å’Œ DELETE çš„æ•ˆç‡ã€‚äº‹åŠ¡è¡¨ï¼ˆåŸºäº ORCï¼‰é€šè¿‡å¼•å…¥deltaæ–‡ä»¶ç­‰æœºåˆ¶éƒ¨åˆ†è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ â€‹â€‹äº‹åŠ¡è¡¨çš„å¼€é”€ï¼šâ€‹â€‹ è™½ç„¶äº‹åŠ¡è¡¨æ”¯æŒ ACIDï¼Œä½†å®ƒä»¬å¼•å…¥äº†é¢å¤–çš„å†™å¼€é”€ï¼ˆç®¡ç†äº‹åŠ¡ã€å‹ç¼© delta æ–‡ä»¶ç­‰ï¼‰ã€‚ä»…å½“ç¡®å®éœ€è¦ç²¾ç»†çš„è¡Œçº§æ“ä½œæ—¶æ‰å¯ç”¨äº‹åŠ¡åŠŸèƒ½ã€‚ â€‹â€‹æ‰¹é‡æ“ä½œä¼˜å…ˆï¼šâ€‹â€‹ Hive æœ€æ“…é•¿çš„æ˜¯æ‰¹å¤„ç†æ“ä½œï¼ˆå¤§è§„æ¨¡çš„ SELECT å’Œ INSERT OVERWRITEï¼‰ã€‚å¯¹äºé¢‘ç¹çš„å•è¡Œ UPDATE/DELETEï¼Œä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“æˆ– NoSQL æ•°æ®åº“å¯èƒ½æ›´åˆé€‚ã€‚ â€‹â€‹åˆ†åŒºä¼˜åŒ–ï¼šâ€‹â€‹ åœ¨å¤§å‹è¡¨ä¸Šï¼ŒWHERE å­å¥åŒ…å«åˆ†åŒºé”®å¯ä»¥æå¤§åœ°å‡å°‘éœ€è¦æ‰«æçš„æ•°æ®é‡ï¼ˆåˆ†åŒºè£å‰ªï¼‰ï¼Œæ˜¾è‘—æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚åˆç†è®¾è®¡åˆ†åŒºç­–ç•¥è‡³å…³é‡è¦ğŸ”§ã€‚","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"DML","slug":"æ•°æ®åº“/DML","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/DML/"},{"name":"HQL","slug":"æ•°æ®åº“/DML/HQL","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/DML/HQL/"}],"tags":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://github.io/wobushick/Hexo/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"Hive","slug":"Hive","permalink":"https://github.io/wobushick/Hexo/tags/Hive/"}]},{"title":"DDLæ•°æ®å®šä¹‰","slug":"DDLæ•°æ®å®šä¹‰","date":"2025-07-12T16:00:00.000Z","updated":"2025-07-15T07:40:10.712Z","comments":true,"path":"2025/07/12/DDLæ•°æ®å®šä¹‰/","permalink":"https://github.io/wobushick/Hexo/2025/07/12/DDL%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89/","excerpt":"","text":"æ•°æ®åº“æ“ä½œåˆ›å»ºæ•°æ®åº“ 123456-- åŸºç¡€åˆ›å»ºCREATE DATABASE IF NOT EXISTS my_db COMMENT &#x27;ä¸šåŠ¡æ•°æ®ä»“åº“&#x27;;-- æŒ‡å®šå­˜å‚¨ä½ç½®CREATE DATABASE my_db LOCATION &#x27;/path/on/hdfs&#x27;; ğŸ’¡ â€‹â€‹æç¤ºï¼šâ€‹â€‹ ä½¿ç”¨ IF NOT EXISTS å¯é¿å…æ•°æ®åº“å·²å­˜åœ¨æ—¶æŠ¥é”™ã€‚ æŸ¥è¯¢æ•°æ®åº“123SHOW DATABASES;SHOW DATABASES LIKE &#x27;test*&#x27;; -- æ”¯æŒæ¨¡ç³ŠåŒ¹é…DESCRIBE DATABASE EXTENDED my_db; ä¿®æ”¹æ•°æ®åº“1ALTER DATABASE my_db SET DBPROPERTIES (&#x27;comment&#x27; = &#x27;æ–°æè¿°&#x27;); âš ï¸ â€‹â€‹æ³¨æ„ï¼šâ€‹â€‹ Hive åªèƒ½ä¿®æ”¹æ³¨é‡Šå’Œå±æ€§ï¼Œä¸èƒ½é‡å‘½åæˆ–æ›´æ”¹ä½ç½®ã€‚ åˆ é™¤æ•°æ®åº“12DROP DATABASE IF EXISTS my_db;DROP DATABASE IF EXISTS my_db CASCADE; âš ï¸ â€‹â€‹è­¦å‘Šï¼šâ€‹â€‹ ç”Ÿäº§ç¯å¢ƒè¯·æ…ç”¨ CASCADEï¼Œé˜²æ­¢è¯¯åˆ æ‰€æœ‰è¡¨æ•°æ®ã€‚ åˆ‡æ¢æ•°æ®åº“12USE my_db;SHOW TABLES; è¡¨æ“ä½œåˆ›å»ºè¡¨åŸºç¡€å»ºè¡¨123456789101112CREATE TABLE IF NOT EXISTS employees ( id INT COMMENT &#x27;å‘˜å·¥ID&#x27;, name STRING COMMENT &#x27;å§“å&#x27;, salary FLOAT COMMENT &#x27;è–ªèµ„&#x27;, join_date DATE COMMENT &#x27;å…¥èŒæ—¥æœŸ&#x27;)COMMENT &#x27;å‘˜å·¥ä¿¡æ¯è¡¨&#x27;ROW FORMAT DELIMITED FIELDS TERMINATED BY &#x27;,&#x27; LINES TERMINATED BY &#x27;\\n&#x27;STORED AS TEXTFILELOCATION &#x27;/user/hive/warehouse/my_db/employees&#x27;; åˆ›å»ºåˆ†åŒºè¡¨123456CREATE TABLE logs ( log_time TIMESTAMP, message STRING)PARTITIONED BY (dt STRING, region STRING)STORED AS ORC; å¤åˆ¶è¡¨ç»“æ„ï¼ˆä¸å«æ•°æ®ï¼‰1CREATE TABLE new_table LIKE old_table; æŸ¥çœ‹è¡¨1234SHOW TABLES;SHOW TABLES LIKE &#x27;emp*&#x27;;DESCRIBE employees;DESCRIBE FORMATTED employees; ä¿®æ”¹è¡¨é‡å‘½åè¡¨1ALTER TABLE employees RENAME TO staff; æ·»åŠ åˆ—123ALTER TABLE staff ADD COLUMNS ( department STRING COMMENT &#x27;éƒ¨é—¨&#x27;); ä¿®æ”¹åˆ—å&#x2F;ç±»å‹12ALTER TABLE staff CHANGE COLUMN salary salary_info DOUBLE COMMENT &#x27;ç¨å‰è–ªèµ„&#x27;; æ·»åŠ &#x2F;åˆ é™¤&#x2F;ä¿®æ”¹åˆ†åŒº1234ALTER TABLE logs ADD PARTITION (dt=&#x27;2023-10-01&#x27;, region=&#x27;Asia&#x27;);ALTER TABLE logs DROP PARTITION (dt=&#x27;2023-10-01&#x27;, region=&#x27;Asia&#x27;);ALTER TABLE logs PARTITION (dt=&#x27;2023-10-01&#x27;, region=&#x27;Asia&#x27;) SET LOCATION &#x27;/new/hdfs/path&#x27;; ä¿®æ”¹è¡¨é‡å‘½åè¡¨1ALTER TABLE employees RENAME TO staff; æ·»åŠ åˆ—123ALTER TABLE staff ADD COLUMNS ( department STRING COMMENT &#x27;éƒ¨é—¨&#x27;); ä¿®æ”¹åˆ—å&#x2F;ç±»å‹12ALTER TABLE staff CHANGE COLUMN salary salary_info DOUBLE COMMENT &#x27;ç¨å‰è–ªèµ„&#x27;; æ·»åŠ &#x2F;åˆ é™¤&#x2F;ä¿®æ”¹åˆ†åŒº1234ALTER TABLE logs ADD PARTITION (dt=&#x27;2023-10-01&#x27;, region=&#x27;Asia&#x27;);ALTER TABLE logs DROP PARTITION (dt=&#x27;2023-10-01&#x27;, region=&#x27;Asia&#x27;);ALTER TABLE logs PARTITION (dt=&#x27;2023-10-01&#x27;, region=&#x27;Asia&#x27;) SET LOCATION &#x27;/new/hdfs/path&#x27;; åˆ é™¤è¡¨12345DROP TABLE IF EXISTS staff;-- å¤–éƒ¨è¡¨ï¼ˆåªåˆ é™¤å…ƒæ•°æ®ï¼‰CREATE EXTERNAL TABLE ext_table (...);DROP TABLE ext_table; æ¸…ç©ºè¡¨æ•°æ®12TRUNCATE TABLE employees;TRUNCATE TABLE logs PARTITION (dt=&#x27;2023-10-01&#x27;); ä½¿ç”¨ CTAS åˆ›å»ºè¡¨12CREATE TABLE IF NOT EXISTS new_tableAS SELECT ...; å†…éƒ¨è¡¨ vs å¤–éƒ¨è¡¨ å¯¹æ¯”ç‰¹æ€§å†…éƒ¨è¡¨ (Managed Table)å¤–éƒ¨è¡¨ (External Table)æ•°æ®æ‰€æœ‰æƒ/æ§åˆ¶æƒHiveæ‹¥æœ‰å¹¶å®Œå…¨æ§åˆ¶æ•°æ®ã€‚â€‹Hiveåªæ‹¥æœ‰å…ƒæ•°æ®ï¼Œæ•°æ®ç”±å¤–éƒ¨æ§åˆ¶ã€‚â€‹åˆ›å»ºè¡¨æ—¶æ•°æ®ä½ç½®â€‹å¯æŒ‡å®š(LOCATION)ï¼Œé»˜è®¤åœ¨ä»“åº“ç›®å½•ä¸‹åˆ›å»ºã€‚â€‹â€‹å¿…é¡»æŒ‡å®š(LOCATION)ï¼ŒæŒ‡å‘å·²æœ‰æ•°æ®ç›®å½•ã€‚â€‹â€‹â€‹DROP TABLEæ“ä½œâ€‹â€‹åˆ é™¤å…ƒæ•°æ® AND åˆ é™¤HDFSä¸Šçš„æ•°æ®æ–‡ä»¶åªåˆ é™¤å…ƒæ•°æ®ï¼ŒHDFSä¸Šçš„æ•°æ®æ–‡ä»¶ä¿æŒä¸åŠ¨ã€‚â€‹æ•°æ®ç”Ÿå‘½å‘¨æœŸâ€‹ç”±Hiveç®¡ç†ï¼Œè¡¨åˆ æ•°æ®å¤±ã€‚ç‹¬ç«‹äºHiveå­˜åœ¨ï¼Œè¡¨åˆ æ•°æ®ç•™ã€‚å…¸å‹ä½¿ç”¨åœºæ™¯â€‹Hiveä¸“ç”¨ä¸­é—´/ä¸´æ—¶è¡¨ï¼›æœ€ç»ˆç»“æœè¡¨(éœ€åˆ æ•°æ®)ã€‚å…±äº«æ•°æ®æºï¼›å¤–éƒ¨åˆ†æï¼›é˜²æ­¢è¯¯åˆ æºæ•°æ®ï¼›å¤šåº”ç”¨å…±äº«ã€‚","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"DDL","slug":"æ•°æ®åº“/DDL","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/DDL/"},{"name":"HQL","slug":"æ•°æ®åº“/DDL/HQL","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/DDL/HQL/"}],"tags":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://github.io/wobushick/Hexo/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"Hive","slug":"Hive","permalink":"https://github.io/wobushick/Hexo/tags/Hive/"}]},{"title":"Hiveå®‰è£…","slug":"Hiveå®‰è£…","date":"2025-07-12T16:00:00.000Z","updated":"2025-07-15T07:40:10.712Z","comments":true,"path":"2025/07/12/Hiveå®‰è£…/","permalink":"https://github.io/wobushick/Hexo/2025/07/12/Hive%E5%AE%89%E8%A3%85/","excerpt":"","text":"ä¸€ã€å‡†å¤‡å·¥ä½œ â€‹â€‹æ³¨æ„:â€‹â€‹ ä»¥ä¸‹æ“ä½œé»˜è®¤æ‚¨å·²é…ç½®å¥½Hadoopç¯å¢ƒ 1. ä¸‹è½½Hive ä¸‹è½½åœ°å€ï¼šHive 3.1.3 ä¸Šä¼ è‡³Linuxçš„/opt/softwareç›®å½• 2. è§£å‹å®‰è£…12tar -zxvf /opt/software/apache-hive-3.1.3-bin.tar.gz -C /opt/modulemv /opt/module/apache-hive-3.1.3-bin /opt/module/hive äºŒã€ç¯å¢ƒé…ç½®1. é…ç½®ç¯å¢ƒå˜é‡ç¼–è¾‘/etc/profileæ–‡ä»¶ï¼šsudo vim /etc/profile åœ¨æ–‡ä»¶åº•éƒ¨æ·»åŠ ï¼š 123# HIVE_HOMEexport HIVE_HOME=/opt/module/hiveexport PATH=$PATH:$HIVE_HOME/bin åˆ·æ–°é…ç½®æ–‡ä»¶ï¼šsource /etc/profile 2. åŒæ­¥Guavaç‰ˆæœ¬12rm $HIVE_HOME/lib/guava-*.jarcp /opt/hadoop-3.2.2/share/hadoop/common/lib/guava-*.jar $HIVE_HOME/lib/ ä¸‰ã€MySQLæ•°æ®åº“é…ç½®1. å®‰è£…MySQL123sudo apt install -y mysql-server-8.0sudo systemctl start mysqlsudo systemctl enable mysql 2. è¿æ¥è¿œç¨‹MySQLmysql -uroot -h192.168.1.3 -p123456 3. å®‰è£…MySQL JDBCé©±åŠ¨123wget https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-8.0.28.tar.gztar -xzvf mysql-connector-java-8.0.28.tar.gzcp mysql-connector-java-8.0.28/mysql-connector-java-8.0.28.jar $HIVE_HOME/lib/ å››ã€Hiveé…ç½®1. åˆ›å»ºhive-site.xml12cd /opt/module/hive/confvim hive-site.xml 2. æ·»åŠ é…ç½®å†…å®¹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;configuration&gt; &lt;!-- æŒ‡å®šHive MetastoreæœåŠ¡çš„URIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰ --&gt; &lt;property&gt; &lt;name&gt;hive.metastore.uris&lt;/name&gt; &lt;value&gt;thrift://192.168.1.6:9083&lt;/value&gt; &lt;!-- MetastoreæœåŠ¡åœ°å€å’Œç«¯å£ --&gt; &lt;/property&gt; &lt;!-- æŒ‡å®šæ˜¯å¦ä½¿ç”¨æœ¬åœ°MetastoreæœåŠ¡ï¼ˆfalseè¡¨ç¤ºä½¿ç”¨è¿œç¨‹æœåŠ¡ï¼‰ --&gt; &lt;property&gt; &lt;name&gt;hive.metastore.local&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;!-- è®¾ç½®ä¸ºfalseå¯ç”¨è¿œç¨‹Metastore --&gt; &lt;/property&gt; &lt;!-- å®šä¹‰JDBCè¿æ¥URLç”¨äºMetastoreæ•°æ®åº“ --&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; &lt;value&gt;jdbc:mysql://192.168.1.3:3306/hive_metastore?createDatabaseIfNotExist=true&amp;amp;useSSL=false&amp;amp;characterEncoding=UTF-8&lt;/value&gt; &lt;!-- jdbc:mysql://[æ•°æ®åº“åœ°å€]:[ç«¯å£]/[æ•°æ®åº“å] createDatabaseIfNotExist=true: è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ï¼ˆé¦–æ¬¡å¯åŠ¨æ—¶ï¼‰ useSSL=false: ç¦ç”¨SSLè¿æ¥ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®å¯ç”¨ï¼‰ characterEncoding=UTF-8: è®¾ç½®å­—ç¬¦ç¼–ç  --&gt; &lt;/property&gt; &lt;!-- æŒ‡å®šJDBCé©±åŠ¨ç±»å --&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; &lt;value&gt;com.mysql.cj.jdbc.Driver&lt;/value&gt; &lt;!-- MySQL JDBCé©±åŠ¨ç±» --&gt; &lt;/property&gt; &lt;!-- å®šä¹‰è¿æ¥Metastoreæ•°æ®åº“çš„ç”¨æˆ·å --&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; &lt;value&gt;root&lt;/value&gt; &lt;!-- æ•°æ®åº“ç”¨æˆ·å --&gt; &lt;/property&gt; &lt;!-- å®šä¹‰è¿æ¥Metastoreæ•°æ®åº“çš„å¯†ç  --&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; &lt;value&gt;123456&lt;/value&gt; &lt;!-- æ•°æ®åº“å¯†ç  --&gt; &lt;/property&gt; &lt;!-- æŒ‡å®šHiveæ•°æ®ä»“åº“çš„HDFSå­˜å‚¨è·¯å¾„ --&gt; &lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive/warehouse&lt;/value&gt; &lt;!-- è¡¨æ•°æ®é»˜è®¤å­˜å‚¨ä½ç½® --&gt; &lt;/property&gt; &lt;!-- æŒ‡å®šHiveä¸´æ—¶æ–‡ä»¶çš„HDFSå­˜å‚¨è·¯å¾„ --&gt; &lt;property&gt; &lt;name&gt;hive.exec.scratchdir&lt;/name&gt; &lt;value&gt;/user/hive/tmp&lt;/value&gt; &lt;!-- ä½œä¸šæ‰§è¡Œæ—¶çš„ä¸´æ—¶æ–‡ä»¶ç›®å½• --&gt; &lt;/property&gt;&lt;/configuration&gt; äº”ã€åˆå§‹åŒ–ä¸å¯åŠ¨1. åˆå§‹åŒ–å…ƒæ•°æ®12cd /opt/module/hive/bin/schematool -dbType mysql -initSchema --verbose 2. å¯åŠ¨MetastoreæœåŠ¡hive --service metastore &gt; /tmp/metastore.log 2&gt;&amp;1 &amp; 3. éªŒè¯ç«¯å£ç›‘å¬netstat -tuln | grep 9083 å…­ã€è¿æ¥æ¨¡å¼ç¤ºæ„å›¾","categories":[{"name":"æ•°æ®å¹³å°","slug":"æ•°æ®å¹³å°","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0/"},{"name":"Hive","slug":"æ•°æ®å¹³å°/Hive","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0/Hive/"}],"tags":[{"name":"Hive","slug":"Hive","permalink":"https://github.io/wobushick/Hexo/tags/Hive/"},{"name":"HQL","slug":"HQL","permalink":"https://github.io/wobushick/Hexo/tags/HQL/"}]}],"categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"DML","slug":"æ•°æ®åº“/DML","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/DML/"},{"name":"HQL","slug":"æ•°æ®åº“/DML/HQL","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/DML/HQL/"},{"name":"DDL","slug":"æ•°æ®åº“/DDL","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/DDL/"},{"name":"HQL","slug":"æ•°æ®åº“/DDL/HQL","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/DDL/HQL/"},{"name":"æ•°æ®å¹³å°","slug":"æ•°æ®å¹³å°","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0/"},{"name":"Hive","slug":"æ•°æ®å¹³å°/Hive","permalink":"https://github.io/wobushick/Hexo/categories/%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0/Hive/"}],"tags":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://github.io/wobushick/Hexo/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"Hive","slug":"Hive","permalink":"https://github.io/wobushick/Hexo/tags/Hive/"},{"name":"HQL","slug":"HQL","permalink":"https://github.io/wobushick/Hexo/tags/HQL/"}]}